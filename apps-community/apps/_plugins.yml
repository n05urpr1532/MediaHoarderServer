- name: Creating scripts and plugins paths
  file: 'path={{item}} state=directory mode=0775 owner=1000 group=1000'
  with_items:
    - '/opt/mhs/apps-data/{{pgrole}}/scripts'
    - '/opt/mhs/apps-data/{{pgrole}}/plugins'

- name: 'Check if Templates Exist for {{pgrole}}'
  stat:
    path: '/opt/mhs/lib/apps-community/apps/templates/{{pgrole}}'
  register: copycheck

- name: 'Copying Scripts & Plugins'
  copy:
    src: '/opt/mhs/lib/apps-community/apps/templates/{{pgrole}}'
    dest: '/opt/mhs/apps-data/'
    directory_mode: yes
    force: yes
    owner: '1000'
    group: '1000'
    mode: 0775
  when: copycheck.stat.exists

# scripts permissions
- name: 'Setting permissions on scripts'
  shell: 'chmod -R 775 /opt/mhs/apps-data/{{pgrole}}/scripts'
- name: 'Setting permissions on plugins for {{pgrole}}'
  shell: 'chmod -R 775 /opt/mhs/apps-data/{{pgrole}}/plugins'

- name: set owner rights on script folder for {{pgrole}}'
  shell: 'chown -cR 1000:1000 /opt/mhs/apps-data/{{pgrole}}/scripts'
- name: set permission on plugin folder for {{pgrole}}'
  shell: 'chown -cR 1000:1000 /opt/mhs/apps-data/{{pgrole}}/plugins'
